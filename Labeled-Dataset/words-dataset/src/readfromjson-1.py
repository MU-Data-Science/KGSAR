"""
Created on %(January 2020)
@author: %(Nouf Arasheed)
This script is used to read information from the .json file generated by Colabeler and save the as .csv file following IAM dataset format
"""


import json
import csv
import sys
import os
pages = os.listdir("/home/nouf/DL_Spanish/words/xmls-labeles/img/")
input_path = "/home/nouf/DL_Spanish/words/xmls-labeles/"
output_path = "/home/nouf/DL_Spanish/words/xmls-labeles/"

for p in pages:
    name = os.path.splitext(p)[0]  
    print(name)
    json_file= open(input_path+name+".json")
    j = json.load(json_file)
    n=1
    with open(output_path+name+"_labels.csv","w",newline='') as file:
            fw = csv.writer(file,delimiter =' ')
            for o in j["outputs"]["object"]:
                fw.writerow([("a"+name+"-000u-00-"+str(n)),"ok","154","1",o["bndbox"]["xmin"],o["bndbox"]["ymin"],o["bndbox"]['xmax'],o["bndbox"]['ymax'],"xx",o["name"].strip()])
                n=n+1

#input_path= '/home/nouf/DL_Spanish/words/yolo-experiment/annotations/'
#"/home/nouf/DL_Spanish/words/pages/"
#output_path = '/home/nouf/DL_Spanish/words/yolo-experiment/annotations/'
#"/home/nouf/DL_Spanish/words/words-files/"
#for name in pages:
 #   print(name)
  #  json_file= open(input_path+name+'.json')
   # j = json.load(json_file)
    #n=1
   # with open(output_path+name+"_labels.csv","w",newline='') as file:
#	    fw = csv.writer(file,delimiter =' ')
#	    for o in j["outputs"]["object"]:
		#fw.writerow ([o["name"],o["bndbox"]["xmin"],o["bndbox"]["ymin"],o["bndbox"]['xmax'],o["bndbox"]['ymax']])
                
 #                   fw.writerow([("a"+name+"-000u-00-"+str(n)),"ok","154","1",o["bndbox"]["xmin"],o["bndbox"]["ymin"],o["bndbox"]['xmax'],o["bndbox"]['ymax'],"xx",o["name"].strip()])
  #                  n=n+1
