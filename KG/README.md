# Generating Knowledge Graphs from the Notary Records

# Description

Generate knowledge graphs by utilizing Resource Description Framework (RDF) on cleaned, denoised images. 

If you want to transfer files between your Cloudlab node and your local system or vice-versa, please use the following:

    $ scp -r src dest

For example, if I wish to transfer files from my local system to Cloudlab:

    $ scp -r /Desktop/folder Creator@Node.Cluster.cloudlab.us:/mydata/folder

Make 3 directories, one for uncleaned-images, cleaned-images and JSON files:

    $ cd KG
    $ mkdir uncleaned-images
    $ mkdir cleaned-images
    $ mkdir JSON
    $ mkdir JSON/Keras

Then, add all the uncleaned images to the 'uncleaned-images' folder.

# Cleaning Images

Run [cleanImage.py](/KG/Code/cleanImage.py) to change blur and threshold values to clean the original, digitized notary records in order for the models to be able to predict well.

To run as a standalone code, please uncomment lines 16-24 & 47 and run as following:

```
    $ python3 cleanImage.py -i /input/path -o /output/path
```

If you are running this as a standalone code, it would mean that you only want to clean the images

# Getting the predictions

Run [predictions.py](/KG/Code/predictions.py) to apply the [Keras-OCR model](/KG/Model/recognizer_custom.h5) to get predictions and bounding boxes for each image.

To run as a standalone code, please uncomment lines 19-33 & 71 and run as following:

```
    $ python3 predictions.py -i /images/path -o /output/path -j /output/json/path -m /model/path
```

If you are running this as a standalone code, it would mean that you already have cleaned images.

# Generating knowledge graphs

Run as [kg.py](/KG/Code/kg.py) to use the predictions and bounding boxes generated by the model to populate knowledge graphs.

If the lines in the above two code files were not uncommented, kg.py will sequentially call the code snippets. Run the code as following:

```
    $ python3 kg.py -i /full/path/to/original/images -o /full/path/to/cleaned/images -j /full/path/to/store/JSONfiles -r /path/to/JSONfiles -m /model/path -e /list/of/notaries/xlsx
```

If you are running this as a standalone code, it would mean that you already have the predictions from the cleaned images.

This pipeline works with Keras-OCR and YOLO-OCR and can take as input, any number of images. Conda environment installation requirements are mentioned in kg.py

## Contributing Authors:

**Shivika Prasanna** 

**Nouf Alrasheed**
